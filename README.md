# 데이터라이즈 프론트엔드 과제 전형
지원자 : 곽민준

## 프로젝트 개요

본 프로젝트는 2025년 10월부터 12월까지의 쇼핑몰 구매 데이터를 기반으로,
구매 현황을 시각화하고 고객 단위의 분석 정보를 제공하는 프론트엔드 대시보드 애플리케이션입니다.

## 실행 방법

### 서버 실행

```bash
cd apps
yarn install
yarn start-server
```

### 클라이언트 실행 (새 터미널)

```bash
cd apps
yarn start-client
```

* Backend: `http://localhost:4000`
* Frontend: `http://localhost:3000`

## 테스트 실행

```bash
cd apps/frontend
yarn test
```
</br>

## 기능 구현
<img width="1920" height="1511" alt="image" src="https://github.com/user-attachments/assets/b775ce33-2d4d-4f14-beb5-89811bdb4bfc" />


### 1. 검색 날짜 범위 설정 기능

* 초기 날짜 범위는 **현재 날짜 기준 최근 3개월**로 설정했습니다.
  데이터 대시보드의 특성상 특정 고정 기간보다 "현재로부터 얼마 동안"의 데이터 조회가 더 중요하다고 판단했습니다.
* 시작일자와 종료일자 입력 시 min, max 값을 설정하여 유효한 날짜 범위만 선택 가능하도록 제한했습니다.
* 사용자가 키보드로 날짜를 직접 입력하는 경우를 고려하여,

  * 시작일이 종료일보다 늦을 경우 **자동으로 날짜를 스왑**하도록 처리했습니다.
* 달력에서 날짜를 삭제하여 값이 비어 있는 상태로 조회하려는 경우,

  * **유효한 날짜를 선택하라는 alert**를 통해 잘못된 요청을 방지했습니다.

### 2. 가격대별 구매 빈도 테이블 & CSV 추출 기능

* 가격대를 2만원 이하 ~ 10만원 이상까지 1만원 단위로 구분하여 구매 빈도를 테이블로 표시했습니다.
* 선택된 날짜 범위(단일 날짜 포함)에 대해:

  * 가격대별 구매 빈도
  * 전체 대비 비율을 **가로 막대 차트 형태로 시각화**했습니다.
* CSV 다운로드 버튼 클릭 시,

  * 현재 설정된 날짜 범위에 해당하는 **구매 데이터를 CSV 파일로 다운로드**할 수 있도록 구현했습니다.

### 3. 고객 목록 검색 / 정렬 기능

* 고객 목록에는 다음 정보를 표시합니다.

  * ID
  * 고객명
  * 총 구매 횟수
  * 총 주문 금액
* 고객 목록은 **페이지네이션**으로 구현했습니다.
* 정렬 UI는 드롭다운 대신,

  * **테이블 헤더의 '총 구매 금액' 옆에 정렬 버튼**을 배치했습니다.
  * 정렬 기준이 늘어날 경우 드롭다운에서 항목을 찾기 어려워질 수 있다고 판단했기 때문입니다.
* 총 구매 금액 기준 **오름차순, 내림차순 정렬**이 가능합니다.
* 고객 이름 검색에는 **디바운스 처리**를 적용하여 불필요한 API 호출을 줄였습니다.

### 4. 고객 상세 구매 내역

* 고객 목록에서 특정 고객을 클릭하면 해당 고객의 상세 구매 내역이 표시됩니다.
  * 구매 날짜
  * 제품명
  * 가격
  * 상품 썸네일
* 대시보드 특성상 모달을 반복적으로 여닫는 UX가 불편하다고 판단하여,

  * **좌측에 고객 목록**
  * **우측에 고객 상세 영역**
    형태의 레이아웃으로 구성했습니다.
* 고객이 하루에 여러 상품을 구매한 경우를 고려하여,

  * **구매 날짜 기준으로 내역을 그룹화**하여 시각적으로 구분했습니다.

</br>

## 로딩 처리 및 데이터 패칭 전략

### 1. 구매 빈도 테이블

* useSuspenseQuery를 사용하고 React `Suspense`로 감싸 로딩 상태를 처리
* 선언적인 로딩 처리 방식이 적합한 영역으로 판단
  (정렬·페이지네이션 등 잦은 재요청이 발생하지 않음)
* 로딩과 성공 상태를 명확히 분리하고, UI 복잡도를 줄이는 목적

### 2. 고객 목록 / 고객 구매 내역

* 정렬, 페이지네이션, 고객 클릭 등으로 **빈번한 데이터 재요청** 발생
* `Suspense` 사용 시

  * 쿼리 재요청마다 컴포넌트 언마운트 → 재마운트 발생
  * UX 측면에서 부적절하다고 판단
* 따라서 useQuery를 사용하고 `isLoading` 기반으로 로딩 상태를 직접 제어
* 로딩 상태는 스피너 UI로 처리

![화면-기록-2026-01-14-오전-7 07 08](https://github.com/user-attachments/assets/f3b84179-ce2a-497b-b77a-763168a38fc0)

### 3. 페이지네이션 로딩 UX 개선

* 페이지 전환 시 데이터는 빠르게 응답되지만
  매번 로딩 UI가 노출되며 **깜빡이는 UX 저하 문제** 발생
* 이를 해결하기 위해:

  * **300ms 이내 응답 시 로딩 UI 미노출**
  * 300ms 이후에도 응답이 없을 경우에만 스피너 표시
* 결과적으로 페이지네이션 전환 시 불필요한 깜빡임 감소

### 4. placeholderData를 활용한 추가 개선

* 미세하게 발생하던 깜빡임을 완전히 제거하기 위해
  `useQuery`의 `placeholderData` 옵션 활용
* 페이지 전환 시:

  * 이전 데이터를 유지한 상태로 렌더링
  * 새로운 데이터 수신 후 자연스럽게 교체
* 페이지네이션 전환 UX를 안정적으로 개선

</br>

## 에러 처리 설계
![화면-기록-2026-01-14-오전-7 01 24](https://github.com/user-attachments/assets/691d59c8-ebdd-412f-9adf-3daf0f31931c)

### 1. 잘못된 경로 처리

* 정의되지 않은 경로 접근 시
  `path="*"` 설정을 통해 `NotFound` 페이지로 이동
* `NotFound` 페이지에서는

  * 경로가 존재하지 않음을 안내하는 문구 제공
  * 메인 페이지로 이동할 수 있는 액션 버튼을 함께 제공
* 사용자가 막히지 않고 자연스럽게 앱 흐름으로 복귀할 수 있도록 구성

### 2. 런타임 에러 처리

* 에러 처리를 위해 `ErrorBoundary`를 도입
* 데이터 패칭 에러도 동일한 흐름으로 처리하기 위해
  `useQuery`에 `throwOnError` 옵션을 적용
* 이를 통해 API 에러가 발생할 경우
  컴포넌트 내부가 아닌 'ErrorBoundary'에서 에러를 일괄 처리

### 3. 에러 복구(재시도) 전략

* `useQueryErrorResetBoundary`의 `reset` 함수를 활용
* `ErrorBoundary` 내부에 다시 시도 버튼을 제공하고,
  버튼 클릭 시:

  * ErrorBoundary 상태를 초기화
  * 실패했던 쿼리가 다시 요청되도록 구성
* 새로고침 없이도 사용자가 직접 복구를 시도할 수 있는 구조

</br>

## 기술 스택
```
"@emotion/react"
"@emotion/styled"
"@tanstack/react-query"
"react-dom"
"react-router"
@testing-library
```

### Emotion (@emotion/react, @emotion/styled)
컴포넌트 단위로 스타일을 분리하고 유지보수성을 높이기 위해 Emotion을 도입했습니다. 인라인 스타일의 한계를 보완하고, 스타일과 로직을 명확히 분리함으로써 코드의 가독성과 재사용성을 개선했습니다.
또한 Emotion은 일부 시나리오에서 Styled Components 대비 더 나은 성능을 보이며, 번들 크기 역시 상대적으로 작아 성능과 효율성 측면에서도 이점이 있다고 판단했습니다.

### TanStack Query (@tanstack/react-query)
서버 상태 관리와 데이터 캐싱, 비동기 데이터 처리의 효율성을 위해 사용했습니다. 대시보드처럼 데이터가 자주 변하지 않는 환경에서 불필요한 네트워크 요청을 줄이고, 성능을 최적화할 수 있습니다.

### React Router (react-router)
SPA 내에서 페이지 전환과 라우팅을 간편하게 처리하기 위해 사용했습니다.
정해진 경로가 아닌 경우 NotFound 페이지로 라우팅하였습니다.

### Testing Library (@testing-library/react, @testing-library/dom, @testing-library/jest-dom, vitest)
React Testing Library와 Vitest를 활용해 사용자 관점의 React 컴포넌트 및 DOM 기반 테스트를 직관적으로 작성할 수 있는 테스트 환경을 구축했습니다.
이를 통해 구현 세부사항에 의존하지 않고, 실제 사용 흐름에 가까운 테스트를 작성하기 위해 해당 스택을 도입했습니다.

</br>

## 폴더 구조
```
frontend/
└─ src/
   ├─ main.tsx                          
   ├─ app/                              # 앱 초기화 및 전역 Provider
   │  ├─ App.tsx
   │  └─ QueryProvider.tsx
   │
   ├─ pages/                            # 라우트 단위 페이지
   │  ├─ Dashboard/
   │  │  ├─ components/                 # 대시보드 페이지 전용 컴포넌트
   │  │  │  ├─ CustomerDetail/
   │  │  │  ├─ CustomerList/
   │  │  │  ├─ DashboardSection/
   │  │  │  ├─ DateRangePicker/
   │  │  │  └─ PurchaseFrequency/
   │  │  │     └─ DownloadCSVButton/
   │  │  ├─ hooks/                      # 대시보드 페이지 전용 훅
   │  │  ├─ utils/                      # 대시보드 페이지 전용 유틸
   │  │  ├─ Dashboard.tsx
   │  │  └─ Dashboard.styled.ts
   │  └─ NotFound/
   │     ├─ NotFound.tsx
   │     └─ NotFound.styled.ts
   │
   ├─ apis/                             # API 계층
   │  ├─ customer/
   │  │  ├─ index.ts                    # API 함수
   │  │  └─ type.ts                     # 타입 정의
   │  └─ purchase/
   │     ├─ index.ts
   │     └─ type.ts
   │
   ├─ shared/                           # 전역 공용 영역
   │  ├─ apis/
   │  │  └─ http.ts                     # HTTP 클라이언트 설정
   │  ├─ components/                    # 재사용 가능한 공용 컴포넌트
   │  ├─ hooks/                         # 전역 커스텀 훅
   │  ├─ utils/                         # 전역 유틸리티
   │  ├─ types/                         # 전역 타입 정의
   │  ├─ styles/                        # 공통 스타일
   │  └─ test/                          # 테스트 유틸리티
   │
   ├─ assets/                           # 정적 리소스
   │  ├─ logo.png
   │  └─ search.svg
   │
   ├─ styles/                           # 전역 스타일
   │  ├─ index.css
   │  └─ reset.css
   │
   └─ test/                             # 테스트 설정
```
* 페이지 중심 구조: pages/를 라우트 단위로 관리, 페이지 전용 로직은 내부에서 관리
* 컴포넌트 폴더: 로직(.tsx), 스타일(.styled.ts), 테스트(.test.tsx)을 결합해 관련도 높은 코드들을 관리
* 확장성: 새 페이지, API 도메인, 공용 컴포넌트 추가 시 기존 구조를 건드리지 않고 자연스럽게 확장 가능

</br>

## 과제 요구사항

<details>
<summary>쇼핑몰 구매 데이터 대시보드 애플리케이션
</summary>

### 과제 개요

지원자님은 쇼핑몰의 구매 데이터를 시각화하고 분석할 수 있는 간단한 대시보드 애플리케이션을 개발하게 됩니다.
이 애플리케이션은 `2025년 10월~12월 (3개월)` 동안 발생한 구매 데이터를 기반으로 몇 가지 주요 정보를 제공해야 합니다.

### 개발 환경 설정

이 프로젝트는 개발 환경의 일관성을 유지하기 위해 특정 버전의 Node.js와 Yarn을 사용하도록 설정되어 있습니다.

- **Node.js:** `22.17.0`
- **Yarn:** `1.22.22`

#### 설치 방법

**프로젝트 의존성 설치 및 실행**
   ```bash
   cd apps
   yarn install
   yarn start-server  # 백엔드 서버 실행 (터미널 1)
   yarn start-client  # 프론트엔드 개발 서버 실행 (터미널 2)
   ```
   - 백엔드 서버: `http://localhost:4000`
   - 프론트엔드: `http://localhost:3000`

**`apps/backend` 폴더 내의 코드는 임의로 수정하지 마세요**  

**제출 시에는 fork된 본인의 레포지토리 링크를 첨부하여 메일로 회신 주시면 확인하겠습니다 :) (원본 저장소에 PR 금지)**
**README 파일에 프로젝트 설정 및 실행 방법을 포함하세요.**

### 요구 사항

#### 1. 가격대별 구매 빈도 테이블 & CSV 추출 기능

- 가격대는 2만원 이하부터 10만원 이상까지 만원 단위로 구분됩니다.
- 날짜 범위 선택 기능: 시작일과 종료일을 선택하여 특정 기간을 조회할 수 있어야 합니다. (단일 날짜 조회도 가능해야 함)
- 데이터 내보내기: 선택된 날짜 범위의 구매 데이터를 CSV 파일로 다운로드 할 수 있어야 합니다.

#### 2. 고객 목록 및 검색 기능

- 날짜 범위에 알맞게 고객 목록이 출력되어야 합니다.
- 고객을 구매 금액 순으로 내림차순/오름차순 정렬하여 보여주는 목록을 구현하세요. (기본 정렬은 ID 오름차순)
- 각 고객의 ID, 이름, 총 구매 횟수, 총 구매 금액을 표시하세요.
- 이름 검색 기능을 구현하세요.

#### 3. 고객 상세 구매 내역

- 날짜 범위에 알맞게 상세 내역이 나타나야 합니다.
- 고객 Row를 클릭하면 해당 고객의 상세 구매 내역을 표시하세요.
- 구매 내역에는 구매 날짜, 제품명, 제품 가격, 구매 수량, 상품 썸네일이 포함되어야 합니다.

### 세부 구현 사항

- 데이터 제공 방식

  - 서버에서 제공되는 API 엔드포인트를 통해 데이터를 가져와야 합니다.
  - API 명세
    1. GET `/api/purchase-frequency` - 가격대별 구매 빈도 데이터를 반환합니다.
       - **쿼리 파라미터 (optional)**
         - `from`: 시작 날짜 (ISO 8601 형식)
         - `to`: 종료 날짜 (ISO 8601 형식)
       - **응답 형식**:
         ```json
         [
           { "range": "0 - 20000", "count": 150 },
           { "range": "20001 - 30000", "count": 120 },
           ...
           { "range": "100001 - Infinity", "count": 50 }
         ]
         ```

    2. GET `/api/purchases` - CSV 추출을 위한 원본 구매 데이터를 반환합니다.
       - **쿼리 파라미터 (optional)**
         - `from`: 시작 날짜 (ISO 8601 형식)
         - `to`: 종료 날짜 (ISO 8601 형식)
       - **응답 형식**:
         ```json
         [
           {
             "date": "2025-10-01",
             "customerName": "황지민",
             "productName": "니트 스웨터",
             "price": 33000,
             "quantity": 2
           },
           ...
         ]
         ```

    3. GET `/api/customers` - 페이지네이션된 고객 목록을 반환합니다.
       - **쿼리 파라미터 (optional)**
         - `sortBy`: 정렬 기준 (가능한 값: asc, desc - 구매 금액 순 정렬)
         - `name`: 이름 검색
         - `page`: 페이지 번호 (기본값: 1)
         - `limit`: 페이지당 항목 수 (기본값: 20, 최대: 100)
       - 응답 형식:
         ```json
         {
           "data": [
             {
               "id": 1,
               "name": "황지민",
               "count": 5, // 총 구매 횟수 (고유한 구매일 기준)
               "totalAmount": 550000
             }
           ],
           "pagination": { ... }
         }
         ```

    4. GET `/api/customers/{id}/purchases` - 특정 고객의 상세 구매 내역을 반환합니다.
        - **응답 형식**:
          ```json
          [
            {
              "date": "2025-10-07",
              "quantity": 1,
              "product": "네이비 맨투맨",
              "price": 31000, // 제품 단가
              "imgSrc": "http://localhost:4000/imgs/sweatshirt.jpg"
            },
            ...
          ]
          ```

- 프론트엔드 기술 스택
  - `apps/frontend` 폴더 안에 미리 React 프로젝트를 세팅해 두었습니다. 이것을 사용하여 애플리케이션을 개발하세요.

### 추가 요구 사항

필수 요구사항이 충분히 구현된 경우, 아래 기능을 추가로 구현하면 가산점이 부여됩니다.

- **테스트**: 주요 기능에 대한 유닛 테스트 또는 통합 테스트 작성

<details>